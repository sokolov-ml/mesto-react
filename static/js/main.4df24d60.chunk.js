(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],[,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/profile__edit.58afbe73.svg"},function(e,t,a){e.exports=a.p+"static/media/profile__add.bdfb8ebb.svg"},function(e,t,a){e.exports=a.p+"static/media/header__logo.855a8c98.svg"},function(e,t,a){e.exports=a.p+"static/media/profile__photo.62cf7cfc.png"},,,function(e,t,a){e.exports=a(21)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(5),c=a.n(o),i=(a(19),a(12)),l=a(1),s=a(6),u=a(7),p=new(function(){function e(t){Object(s.a)(this,e),this._options=t,this._url=t.baseUrl,this._token=t.headers.authorization,this._path={user:"/users/me",cards:"/cards",avatar:"/users/me/avatar"}}return Object(u.a)(e,[{key:"_fetch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2?arguments[2]:void 0;return fetch("".concat(this._options.baseUrl).concat(e),{headers:this._options.headers,method:t,body:JSON.stringify(a)}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getCurrentUserInfo",value:function(){return this._fetch(this._path.user)}},{key:"updateCurrentUserInfo",value:function(e,t){return this._fetch(this._path.user,"PATCH",{name:e,about:t})}},{key:"updateCurrentUserPhoto",value:function(e){return this._fetch(this._path.avatar,"PATCH",{avatar:e})}},{key:"getCards",value:function(){return this._fetch(this._path.cards)}},{key:"addNewCard",value:function(e,t){return this._fetch(this._path.cards,"POST",{name:e,link:t})}},{key:"removeCard",value:function(e){return this._fetch("".concat(this._path.cards,"/").concat(e),"DELETE")}},{key:"setLikeCardOn",value:function(e){return this._fetch("".concat(this._path.cards,"/likes/").concat(e),"PUT")}},{key:"setLikeCardOff",value:function(e){return this._fetch("".concat(this._path.cards,"/likes/").concat(e),"DELETE")}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-14",headers:{authorization:"23bbe762-c214-4ce4-b9fd-b26b33fa43ee","Content-Type":"application/json"}});function m(e){return r.a.createElement("header",{className:"header"},r.a.createElement("img",{src:e.logo,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f",className:"header__logo"}))}var d=r.a.createContext();function f(e){var t=e.card,a=e.onCardClick,n=e.onCardLike,o=e.onCardDelete,c=r.a.useContext(d),i=r.a.useState(t.likes.some((function(e){return e._id===c._id}))),s=Object(l.a)(i,2),u=s[0],p=s[1],m=r.a.useState(t.likes.length),f=Object(l.a)(m,2),_=f[0],h=f[1];return r.a.createElement("li",{className:"elements__element"},r.a.createElement("img",{src:t.link,alt:t.name,className:"elements__image",onClick:function(){a(t)}}),t.owner._id===c._id?r.a.createElement("button",{className:"elements__remove",onClick:function(){return o(t._id)}}):"",r.a.createElement("div",{className:"elements__caption"},r.a.createElement("p",{className:"elements__title"},t.name),r.a.createElement("div",{className:"elements__like"},r.a.createElement("button",{className:"elements__like-button ".concat(u?"elements__like-button_active":""),onClick:function(){n(t._id,u).then((function(e){h(e.likes.length),p(!u)})).catch((function(){console.log("can`t render like")}))},title:t.likes.map((function(e){return e.name})).join(", ")}),r.a.createElement("p",{className:"elements__like-counter"},_))))}var _=a(8),h=a.n(_),v=a(9),E=a.n(v);function b(e){var t=r.a.useContext(d);return r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__photo-overlay",onClick:e.onEditAvatar},r.a.createElement("img",{src:t.avatar,alt:"\u0424\u043e\u0442\u043e \u043f\u0440\u043e\u0444\u0438\u043b\u044f",className:"profile__photo"})),r.a.createElement("div",{className:"profile__info"},r.a.createElement("div",{className:"profile__title"},r.a.createElement("h1",{className:"profile__name"},t.name),r.a.createElement("button",{className:"profile__edit-btn",onClick:e.onEditProfile},r.a.createElement("img",{src:h.a,alt:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",className:"profile__edit-img"}))),r.a.createElement("p",{className:"profile__status"},t.about)),r.a.createElement("button",{className:"profile__add-btn",onClick:e.onAddPlace},r.a.createElement("img",{src:E.a,alt:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",className:"profile__add-img"}))),r.a.createElement("ul",{className:"elements"},e.cards.map((function(t){return r.a.createElement(f,{key:t._id,card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})}))),e.children)}function g(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))}var C=function(e){var t=r.a.useCallback((function(t){"Escape"===t.key&&e.onClose()}),[]),a=r.a.useCallback((function(t){t.target.classList.contains("popup")&&e.onClose()}),[]);return r.a.useEffect((function(){!0===e.isOpen?(document.addEventListener("keydown",t),document.addEventListener("mousedown",a)):(document.removeEventListener("keydown",t),document.removeEventListener("mousedown",a))}),[e,t,a]),r.a.createElement("div",null,r.a.createElement("div",{className:"popup ".concat(e.isOpen?"popup_opened":"")},r.a.createElement("div",{className:"popup__container"},r.a.createElement("button",{type:"button",className:"popup__close",onClick:e.onClose}),e.children)))};function k(e){return r.a.createElement(C,{isOpen:e.isOpen,onClose:e.onClose},r.a.createElement("form",{className:"popup__form popup__form_edit-profile",name:"edit-profile",onSubmit:e.onSubmit},r.a.createElement("h2",{className:"popup__heading"},e.title),e.children))}function N(e){return r.a.createElement(C,{isOpen:!!e.card,onClose:e.onClose},r.a.createElement("figure",{className:"popup__figure"},r.a.createElement("img",{src:e.card?e.card.link:"#",alt:e.card?e.card.name:"",className:"popup__image"}),r.a.createElement("figcaption",{className:"popup__caption"},e.card?e.card.name:"")))}var O=a(13);var y=function(e){var t=e.onUpdateAvatar,a=Object(O.a)(e,["onUpdateAvatar"]),n=r.a.useRef(),o=r.a.useState(!1),c=Object(l.a)(o,2),i=c[0],s=c[1];return r.a.createElement(k,Object.assign({title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"update-avatar"},a,{onSubmit:function(e){e.preventDefault(),console.log(n.current.value),t({avatar:n.current.value},s)}}),r.a.createElement("label",{htmlFor:"input-update-avatar",className:"popup__field"},r.a.createElement("input",{ref:n,type:"url",name:"avatar",id:"input-update-avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__input_field_avatar",required:!0}),r.a.createElement("span",{className:"popup__input-error",id:"input-update-avatar-error"})),r.a.createElement("button",{type:"submit",className:"popup__save"},i?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))};var j=function(e){var t=r.a.useContext(d),a=r.a.useState(""),n=Object(l.a)(a,2),o=n[0],c=n[1],i=r.a.useState(""),s=Object(l.a)(i,2),u=s[0],p=s[1],m=r.a.useState(!1),f=Object(l.a)(m,2),_=f[0],h=f[1];return r.a.useEffect((function(){c(t.name),p(t.about)}),[t]),r.a.createElement(k,Object.assign({title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit-profile"},e,{onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:u},h)}}),r.a.createElement("label",{htmlFor:"input-profile-name",className:"popup__field"},r.a.createElement("input",{type:"text",name:"name",id:"input-profile-name",className:"popup__input popup__input_field_name",required:!0,minLength:"2",maxLength:"40",value:o,onChange:function(e){return c(e.target.value)}}),r.a.createElement("span",{className:"popup__input-error",id:"input-profile-name-error"})),r.a.createElement("label",{htmlFor:"input-profile-about",className:"popup__field"},r.a.createElement("input",{type:"text",name:"about",id:"input-profile-about",className:"popup__input popup__input_field_about",required:!0,minLength:"2",maxLength:"200",value:u,onChange:function(e){return p(e.target.value)}}),r.a.createElement("span",{className:"popup__input-error",id:"input-profile-about-error"})),r.a.createElement("button",{type:"submit",className:"popup__save"},_?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))};var S=function(e){var t=r.a.useState(!1),a=Object(l.a)(t,2),n=a[0],o=a[1],c=r.a.useState(""),i=Object(l.a)(c,2),s=i[0],u=i[1],p=r.a.useState(""),m=Object(l.a)(p,2),d=m[0],f=m[1];return r.a.createElement(k,Object.assign({title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-card"},e,{onSubmit:function(t){t.preventDefault(),e.onAddPlace({name:s,link:d},o)}}),r.a.createElement("label",{htmlFor:"input-addcard-location",className:"popup__field"},r.a.createElement("input",{type:"text",name:"location",id:"input-addcard-location",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input popup__input_field_location",required:!0,minLength:"1",maxLength:"30",value:s,onChange:function(e){return u(e.target.value)}}),r.a.createElement("span",{className:"popup__input-error",id:"input-addcard-location-error"})),r.a.createElement("label",{htmlFor:"input-addcard-image",className:"popup__field"},r.a.createElement("input",{type:"url",name:"image",id:"input-addcard-image",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__input_field_image",value:d,onChange:function(e){return f(e.target.value)},required:!0}),r.a.createElement("span",{className:"popup__input-error",id:"input-addcard-image-error"})),r.a.createElement("button",{type:"submit",className:"popup__save"},n?"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435...":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"))},L=(a(20),a(10)),U=a.n(L),w=a(11),x=a.n(w);var P=function(){var e=r.a.useState(!1),t=Object(l.a)(e,2),a=t[0],n=t[1],o=r.a.useState(!1),c=Object(l.a)(o,2),s=c[0],u=c[1],f=r.a.useState(!1),_=Object(l.a)(f,2),h=_[0],v=_[1],E=r.a.useState(!1),C=Object(l.a)(E,2),O=C[0],L=C[1],w=r.a.useState(),P=Object(l.a)(w,2),A=P[0],D=P[1],T=r.a.useState({name:"",about:"",avatar:x.a}),I=Object(l.a)(T,2),F=I[0],q=I[1],J=r.a.useState([]),z=Object(l.a)(J,2),B=z[0],H=z[1];function M(){n(!1),u(!1),v(!1),L(!1),D()}return r.a.useEffect((function(){p.getCards().then((function(e){H(e)})).catch((function(){console.error("can`t get userInfo")}))}),[]),r.a.useEffect((function(){p.getCurrentUserInfo().then((function(e){q(e)})).catch((function(){console.error("can`t get userInfo")}))}),[]),r.a.createElement(d.Provider,{value:F},r.a.createElement("div",{className:"content"},r.a.createElement(m,{logo:U.a}),r.a.createElement(b,{cards:B,onEditProfile:function(){n(!0)},onAddPlace:function(){u(!0)},onEditAvatar:function(){v(!0)},onCardClick:function(e){D(e)},onCardLike:function(e,t){return t?p.setLikeCardOff(e).catch((function(){console.error("can`t unset like")})):p.setLikeCardOn(e).catch((function(){console.error("can`t set like")}))},onCardDelete:function(e){p.removeCard(e).then((function(){H(B.filter((function(t){return t._id!==e})))})).catch((function(){console.error("can`t delete cards")})).finally((function(){}))}},r.a.createElement(y,{isOpen:h,onClose:M,onUpdateAvatar:function(e,t){t(!0),p.updateCurrentUserPhoto(e.avatar).then((function(e){q(e),M()})).catch((function(){console.error("can`t update user avatar")})).finally((function(){t(!1)}))}}),r.a.createElement(j,{isOpen:a,onClose:M,onUpdateUser:function(e,t){t(!0),p.updateCurrentUserInfo(e.name,e.about).then((function(e){q(e),M()})).catch((function(){console.error("can`t update userinfo")})).finally((function(){t(!1)}))}}),r.a.createElement(S,{isOpen:s,onClose:M,onAddPlace:function(e,t){t(!0),p.addNewCard(e.name,e.link).then((function(e){H([e].concat(Object(i.a)(B))),M()})).catch((function(){console.error("can`t add card")})).finally((function(){t(!1)}))}}),r.a.createElement(k,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"remove-card",isOpen:O,onClose:M},r.a.createElement("button",{type:"submit",className:"popup__save"},"\u0414\u0430")),r.a.createElement(N,{card:A,onClose:M})),r.a.createElement(g,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[14,1,2]]]);
//# sourceMappingURL=main.4df24d60.chunk.js.map